{"version":3,"sources":["../../../node_modules/.pnpm/node-fetch-native@1.6.7/node_modules/node-fetch-native/dist/chunks/multipart-parser.cjs"],"sourcesContent":["\"use strict\";var y=Object.defineProperty;var c=(R,o)=>y(R,\"name\",{value:o,configurable:!0});const node=require(\"../node.cjs\");require(\"node:http\"),require(\"node:https\"),require(\"node:zlib\"),require(\"node:stream\"),require(\"node:buffer\"),require(\"node:util\"),require(\"../shared/node-fetch-native.DhEqb06g.cjs\"),require(\"node:url\"),require(\"node:net\"),require(\"node:fs\"),require(\"node:path\");let s=0;const S={START_BOUNDARY:s++,HEADER_FIELD_START:s++,HEADER_FIELD:s++,HEADER_VALUE_START:s++,HEADER_VALUE:s++,HEADER_VALUE_ALMOST_DONE:s++,HEADERS_ALMOST_DONE:s++,PART_DATA_START:s++,PART_DATA:s++,END:s++};let f=1;const F={PART_BOUNDARY:f,LAST_BOUNDARY:f*=2},LF=10,CR=13,SPACE=32,HYPHEN=45,COLON=58,A=97,Z=122,lower=c(R=>R|32,\"lower\"),noop=c(()=>{},\"noop\"),g=class g{constructor(o){this.index=0,this.flags=0,this.onHeaderEnd=noop,this.onHeaderField=noop,this.onHeadersEnd=noop,this.onHeaderValue=noop,this.onPartBegin=noop,this.onPartData=noop,this.onPartEnd=noop,this.boundaryChars={},o=`\\r\n--`+o;const t=new Uint8Array(o.length);for(let n=0;n<o.length;n++)t[n]=o.charCodeAt(n),this.boundaryChars[t[n]]=!0;this.boundary=t,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=S.START_BOUNDARY}write(o){let t=0;const n=o.length;let E=this.index,{lookbehind:l,boundary:h,boundaryChars:H,index:e,state:a,flags:d}=this;const b=this.boundary.length,m=b-1,O=o.length;let r,P;const u=c(D=>{this[D+\"Mark\"]=t},\"mark\"),i=c(D=>{delete this[D+\"Mark\"]},\"clear\"),T=c((D,p,_,N)=>{(p===void 0||p!==_)&&this[D](N&&N.subarray(p,_))},\"callback\"),L=c((D,p)=>{const _=D+\"Mark\";_ in this&&(p?(T(D,this[_],t,o),delete this[_]):(T(D,this[_],o.length,o),this[_]=0))},\"dataCallback\");for(t=0;t<n;t++)switch(r=o[t],a){case S.START_BOUNDARY:if(e===h.length-2){if(r===HYPHEN)d|=F.LAST_BOUNDARY;else if(r!==CR)return;e++;break}else if(e-1===h.length-2){if(d&F.LAST_BOUNDARY&&r===HYPHEN)a=S.END,d=0;else if(!(d&F.LAST_BOUNDARY)&&r===LF)e=0,T(\"onPartBegin\"),a=S.HEADER_FIELD_START;else return;break}r!==h[e+2]&&(e=-2),r===h[e+2]&&e++;break;case S.HEADER_FIELD_START:a=S.HEADER_FIELD,u(\"onHeaderField\"),e=0;case S.HEADER_FIELD:if(r===CR){i(\"onHeaderField\"),a=S.HEADERS_ALMOST_DONE;break}if(e++,r===HYPHEN)break;if(r===COLON){if(e===1)return;L(\"onHeaderField\",!0),a=S.HEADER_VALUE_START;break}if(P=lower(r),P<A||P>Z)return;break;case S.HEADER_VALUE_START:if(r===SPACE)break;u(\"onHeaderValue\"),a=S.HEADER_VALUE;case S.HEADER_VALUE:r===CR&&(L(\"onHeaderValue\",!0),T(\"onHeaderEnd\"),a=S.HEADER_VALUE_ALMOST_DONE);break;case S.HEADER_VALUE_ALMOST_DONE:if(r!==LF)return;a=S.HEADER_FIELD_START;break;case S.HEADERS_ALMOST_DONE:if(r!==LF)return;T(\"onHeadersEnd\"),a=S.PART_DATA_START;break;case S.PART_DATA_START:a=S.PART_DATA,u(\"onPartData\");case S.PART_DATA:if(E=e,e===0){for(t+=m;t<O&&!(o[t]in H);)t+=b;t-=m,r=o[t]}if(e<h.length)h[e]===r?(e===0&&L(\"onPartData\",!0),e++):e=0;else if(e===h.length)e++,r===CR?d|=F.PART_BOUNDARY:r===HYPHEN?d|=F.LAST_BOUNDARY:e=0;else if(e-1===h.length)if(d&F.PART_BOUNDARY){if(e=0,r===LF){d&=~F.PART_BOUNDARY,T(\"onPartEnd\"),T(\"onPartBegin\"),a=S.HEADER_FIELD_START;break}}else d&F.LAST_BOUNDARY&&r===HYPHEN?(T(\"onPartEnd\"),a=S.END,d=0):e=0;if(e>0)l[e-1]=r;else if(E>0){const D=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);T(\"onPartData\",0,E,D),E=0,u(\"onPartData\"),t--}break;case S.END:break;default:throw new Error(`Unexpected state entered: ${a}`)}L(\"onHeaderField\"),L(\"onHeaderValue\"),L(\"onPartData\"),this.index=e,this.state=a,this.flags=d}end(){if(this.state===S.HEADER_FIELD_START&&this.index===0||this.state===S.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==S.END)throw new Error(\"MultipartParser.end(): stream ended unexpectedly\")}};c(g,\"MultipartParser\");let MultipartParser=g;function _fileName(R){const o=R.match(/\\bfilename=(\"(.*?)\"|([^()<>@,;:\\\\\"/[\\]?={}\\s\\t]+))($|;\\s)/i);if(!o)return;const t=o[2]||o[3]||\"\";let n=t.slice(t.lastIndexOf(\"\\\\\")+1);return n=n.replace(/%22/g,'\"'),n=n.replace(/&#(\\d{4});/g,(E,l)=>String.fromCharCode(l)),n}c(_fileName,\"_fileName\");async function toFormData(R,o){if(!/multipart/i.test(o))throw new TypeError(\"Failed to fetch\");const t=o.match(/boundary=(?:\"([^\"]+)\"|([^;]+))/i);if(!t)throw new TypeError(\"no or bad content-type header, no multipart boundary\");const n=new MultipartParser(t[1]||t[2]);let E,l,h,H,e,a;const d=[],b=new node.FormData,m=c(i=>{h+=u.decode(i,{stream:!0})},\"onPartData\"),O=c(i=>{d.push(i)},\"appendToFile\"),r=c(()=>{const i=new node.File(d,a,{type:e});b.append(H,i)},\"appendFileToFormData\"),P=c(()=>{b.append(H,h)},\"appendEntryToFormData\"),u=new TextDecoder(\"utf-8\");u.decode(),n.onPartBegin=function(){n.onPartData=m,n.onPartEnd=P,E=\"\",l=\"\",h=\"\",H=\"\",e=\"\",a=null,d.length=0},n.onHeaderField=function(i){E+=u.decode(i,{stream:!0})},n.onHeaderValue=function(i){l+=u.decode(i,{stream:!0})},n.onHeaderEnd=function(){if(l+=u.decode(),E=E.toLowerCase(),E===\"content-disposition\"){const i=l.match(/\\bname=(\"([^\"]*)\"|([^()<>@,;:\\\\\"/[\\]?={}\\s\\t]+))/i);i&&(H=i[2]||i[3]||\"\"),a=_fileName(l),a&&(n.onPartData=O,n.onPartEnd=r)}else E===\"content-type\"&&(e=l);l=\"\",E=\"\"};for await(const i of R)n.write(i);return n.end(),b}c(toFormData,\"toFormData\"),exports.toFormData=toFormData;\n"],"mappings":"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","names":[]}