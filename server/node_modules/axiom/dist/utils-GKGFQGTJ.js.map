{"version":3,"sources":["../../../node_modules/.pnpm/ohash@2.0.11/node_modules/ohash/dist/utils/index.mjs"],"sourcesContent":["import { s as serialize } from '../shared/ohash.D__AXeF1.mjs';\nexport { i as isEqual } from '../shared/ohash.D__AXeF1.mjs';\n\nfunction diff(obj1, obj2) {\n  const h1 = _toHashedObject(obj1);\n  const h2 = _toHashedObject(obj2);\n  return _diff(h1, h2);\n}\nfunction _diff(h1, h2) {\n  const diffs = [];\n  const allProps = /* @__PURE__ */ new Set([\n    ...Object.keys(h1.props || {}),\n    ...Object.keys(h2.props || {})\n  ]);\n  if (h1.props && h2.props) {\n    for (const prop of allProps) {\n      const p1 = h1.props[prop];\n      const p2 = h2.props[prop];\n      if (p1 && p2) {\n        diffs.push(..._diff(h1.props?.[prop], h2.props?.[prop]));\n      } else if (p1 || p2) {\n        diffs.push(\n          new DiffEntry((p2 || p1).key, p1 ? \"removed\" : \"added\", p2, p1)\n        );\n      }\n    }\n  }\n  if (allProps.size === 0 && h1.hash !== h2.hash) {\n    diffs.push(new DiffEntry((h2 || h1).key, \"changed\", h2, h1));\n  }\n  return diffs;\n}\nfunction _toHashedObject(obj, key = \"\") {\n  if (obj && typeof obj !== \"object\") {\n    return new DiffHashedObject(key, obj, serialize(obj));\n  }\n  const props = {};\n  const hashes = [];\n  for (const _key in obj) {\n    props[_key] = _toHashedObject(obj[_key], key ? `${key}.${_key}` : _key);\n    hashes.push(props[_key].hash);\n  }\n  return new DiffHashedObject(key, obj, `{${hashes.join(\":\")}}`, props);\n}\nclass DiffEntry {\n  constructor(key, type, newValue, oldValue) {\n    this.key = key;\n    this.type = type;\n    this.newValue = newValue;\n    this.oldValue = oldValue;\n  }\n  toString() {\n    return this.toJSON();\n  }\n  toJSON() {\n    switch (this.type) {\n      case \"added\": {\n        return `Added   \\`${this.key}\\``;\n      }\n      case \"removed\": {\n        return `Removed \\`${this.key}\\``;\n      }\n      case \"changed\": {\n        return `Changed \\`${this.key}\\` from \\`${this.oldValue?.toString() || \"-\"}\\` to \\`${this.newValue.toString()}\\``;\n      }\n    }\n  }\n}\nclass DiffHashedObject {\n  constructor(key, value, hash, props) {\n    this.key = key;\n    this.value = value;\n    this.hash = hash;\n    this.props = props;\n  }\n  toString() {\n    if (this.props) {\n      return `{${Object.keys(this.props).join(\",\")}}`;\n    } else {\n      return JSON.stringify(this.value);\n    }\n  }\n  toJSON() {\n    const k = this.key || \".\";\n    if (this.props) {\n      return `${k}({${Object.keys(this.props).join(\",\")}})`;\n    }\n    return `${k}(${this.value})`;\n  }\n}\n\nexport { diff };\n"],"mappings":"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","names":[]}